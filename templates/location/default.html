<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>전동킥보드 주차장 지도</title>
</head>
<body>
	<h2>전동킥보드 주차장 지도</h2>
	<div class="map_wrap">
		<div id="map" style="width:1000px;height:600px;"></div>
	</div>
	<form method="post">
		{% csrf_token %}
		<div class="form-group">
			<p><label for="id_E">E구역:</label>
				<input type="checkbox" name="E" id="id_E" value="True">
			</p>
			<p><label for="id_N">N구역:</label>
				<input type="checkbox" name="N" id="id_N">
			</p>
			<p><label for="id_S">S구역:</label>
				<input type="checkbox" name="S" id="id_S">
			</p>
		</div>
		<button type="submit">search</button>
	</form>
	<div class="container">
		<div id="lat" style="display: none">
    		<ul>
   	 			{% for pl in parkinglots %}
     	   			<li>{{pl.latitude}}</li>
    			{% endfor %}
    		</ul>
		</div>
		<div id="lon" style="display: none">
    		<ul>
    			{% for pl in parkinglots %}
        			<li>{{pl.longitude}}</li>
    			{% endfor %}
    		</ul>
		</div>
		<div id="areaT" style="display: none">
    		<ul>
    			{% for pl in parkinglots %}
        			<li>{{pl.areatype}}</li>
    			{% endfor %}
    		</ul>
		</div>
	</div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=796522558bb0e42d1eb6354c6db96abe"></script>
	<script>
		console.log(areaT)
		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(36.62842348287764, 127.45741876801542),
			level: 4	// 지도 확대 정도 조절
		};

		var map = new kakao.maps.Map(container, options);

        var list_lat = document.getElementById("lat").innerText.split('\n');
        var list_lon = document.getElementById("lon").innerText.split('\n');

		// 마커 이미지 불러오기
		var imageSrc = '/static/marker.png'
		var imageSize = new kakao.maps.Size(37, 39)	// 마커 이미지 크기 (width, height)
		var imageOption = {offset: new kakao.maps.Point(27, 69)};	// 마커 이미지 옵션

		// 마커의 이미지 정보를 가지고 있는 마커 이미지 생성하기
		var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);

        // 마커 위치 지정
        var markerPositions = new Array();
        for (var idx = 0; idx < list_lon.length; idx++) {
            markerPositions.push( new kakao.maps.LatLng(list_lat[idx], list_lon[idx]));
        }

        // 마커 생성
        var markers = new Array();
        for (var idx = 0; idx < list_lon.length; idx++) {
            markers.push( new kakao.maps.Marker({
                position: markerPositions[idx],
				image: markerImage
            }));
        }

        for (var idx = 0; idx < list_lon.length; idx++) {
            markers[idx].setMap(map);
        }

	</script>
</body>
</html>